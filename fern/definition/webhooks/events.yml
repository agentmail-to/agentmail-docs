# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  inboxes: ../inboxes/__package__.yml
  messages: ../messages.yml
  webhooks: __package__.yml

types:
  EventId:
    type: string
    docs: ID of event.

  Timestamp:
    type: datetime
    docs: Timestamp of event.

  Recipient:
    properties:
      address:
        type: string
        docs: Recipient address.
      status:
        type: string
        docs: Recipient status.

  Send:
    properties:
      inbox_id: inboxes.InboxId
      message_id: messages.MessageId
      timestamp: Timestamp
      recipients:
        type: list<string>
        docs: Sent recipients.

  Delivery:
    properties:
      inbox_id: inboxes.InboxId
      message_id: messages.MessageId
      timestamp: Timestamp
      recipients:
        type: list<string>
        docs: Delivered recipients.

  Bounce:
    properties:
      inbox_id: inboxes.InboxId
      message_id: messages.MessageId
      timestamp: Timestamp
      type:
        type: string
        docs: Bounce type.
      sub_type:
        type: string
        docs: Bounce sub-type.
      recipients:
        type: list<Recipient>
        docs: Bounced recipients.

  Complaint:
    properties:
      inbox_id: inboxes.InboxId
      message_id: messages.MessageId
      timestamp: Timestamp
      type:
        type: string
        docs: Complaint type.
      sub_type:
        type: string
        docs: Complaint sub-type.
      recipients:
        type: list<string>
        docs: Complained recipients.

  Reject:
    properties:
      inbox_id: inboxes.InboxId
      message_id: messages.MessageId
      timestamp: Timestamp
      reason:
        type: string
        docs: Reject reason.

  MessageReceivedPayload:
    properties:
      event_type: webhooks.EventType
      event_id: EventId
      message: messages.Message

  MessageSentPayload:
    properties:
      event_type: webhooks.EventType
      event_id: EventId
      send: Send

  MessageDeliveredPayload:
    properties:
      event_type: webhooks.EventType
      event_id: EventId
      delivery: Delivery

  MessageBouncedPayload:
    properties:
      event_type: webhooks.EventType
      event_id: EventId
      bounce: Bounce

  MessageComplainedPayload:
    properties:
      event_type: webhooks.EventType
      event_id: EventId
      complaint: Complaint

  MessageRejectedPayload:
    properties:
      event_type: webhooks.EventType
      event_id: EventId
      reject: Reject

  SvixId:
    type: string
    docs: ID of webhook message.

  SvixTimestamp:
    type: datetime
    docs: Timestamp of webhook message.

  SvixSignature:
    type: string
    docs: Signature of webhook message.

webhooks:
  messageReceived:
    display-name: Message Received
    method: POST
    headers:
      svix-id: SvixId
      svix-signature: SvixSignature
      svix-timestamp: SvixTimestamp
    payload: MessageReceivedPayload

  messageSent:
    display-name: Message Sent
    method: POST
    headers:
      svix-id: SvixId
      svix-signature: SvixSignature
      svix-timestamp: SvixTimestamp
    payload: MessageSentPayload

  messageDelivered:
    display-name: Message Delivered
    method: POST
    headers:
      svix-id: SvixId
      svix-signature: SvixSignature
      svix-timestamp: SvixTimestamp
    payload: MessageDeliveredPayload

  messageBounced:
    display-name: Message Bounced
    method: POST
    headers:
      svix-id: SvixId
      svix-signature: SvixSignature
      svix-timestamp: SvixTimestamp
    payload: MessageBouncedPayload

  messageComplained:
    display-name: Message Complained
    method: POST
    headers:
      svix-id: SvixId
      svix-signature: SvixSignature
      svix-timestamp: SvixTimestamp
    payload: MessageComplainedPayload

  messageRejected:
    display-name: Message Rejected
    method: POST
    headers:
      svix-id: SvixId
      svix-signature: SvixSignature
      svix-timestamp: SvixTimestamp
    payload: MessageRejectedPayload
