# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  inboxes: inboxes.yml
  messages: messages.yml

service:
  base-path: /inboxes/{inbox_id}/threads
  path-parameters:
    inbox_id: string

  auth: true

  endpoints:
    listThreads:
      docs: Ordered by `updated_at` descending.
      method: GET
      path: /
      request:
        name: ListThreadsRequest
        query-parameters:
          limit: optional<integer>
          last_key: optional<string>
      response: ListThreadsResponse
      errors:
        - inboxes.InboxDoesNotExistError

    getThread:
      docs: Messages ordered by `sent_at` ascending.
      method: GET
      path: /{thread_id}
      path-parameters:
        thread_id: string
      response: Thread
      errors:
        - inboxes.InboxDoesNotExistError
        - ThreadDoesNotExistError

    deleteThread:
      docs: Deletes thread and all of its messages.
      method: DELETE
      path: /{thread_id}
      path-parameters:
        thread_id: string
      errors:
        - inboxes.InboxDoesNotExistError
        - ThreadDoesNotExistError

types:
  ThreadItem:
    properties:
      id: string
      updated_at: datetime
      subject: string

  Thread:
    properties:
      id: string
      created_at: datetime
      updated_at: datetime
      subject: string
      messages: list<messages.Message>

  ListThreadsResponse:
    properties:
      threads: list<ThreadItem>
      limit: integer
      count: integer
      last_key: optional<string>

errors:
  ThreadDoesNotExistError:
    status-code: 404
    type: string
