# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  shared: __package__.yml
  inboxes: inboxes.yml
  threads: threads.yml
  messages: messages.yml

types:
  DraftId:
    type: string
    docs: ID of draft.

  DraftEventId:
    type: string
    docs: Event ID of draft.

  DraftLabels:
    type: list<string>
    docs: Labels of draft.

  DraftUpdatedAt:
    type: datetime
    docs: Time at which draft was last updated.

  DraftCreatedAt:
    type: datetime
    docs: Time at which draft was created.

  DraftTo:
    type: list<string>
    docs: Addresses of recipients. In format `username@domain.com` or `Display Name <username@domain.com>`.

  DraftCc:
    type: list<string>
    docs: Addresses of CC recipients. In format `username@domain.com` or `Display Name <username@domain.com>`.

  DraftBcc:
    type: list<string>
    docs: Addresses of BCC recipients. In format `username@domain.com` or `Display Name <username@domain.com>`.

  DraftSubject:
    type: string
    docs: Subject of draft.

  DraftPreview:
    type: string
    docs: Text preview of draft.

  DraftText:
    type: string
    docs: Plain text body of draft.

  DraftHtml:
    type: string
    docs: HTML body of draft.

  DraftAttachments:
    type: list<messages.Attachment>
    docs: Attachments in draft.

  DraftInReplyTo:
    type: string
    docs: ID of message being replied to.

  DraftReferences:
    type: list<string>
    docs: IDs of previous messages in draft.

  DraftItem:
    properties:
      inbox_id: inboxes.InboxId
      thread_id: threads.ThreadId
      draft_id: DraftId
      event_id: DraftEventId
      labels: DraftLabels
      updated_at: DraftUpdatedAt
      created_at: DraftCreatedAt
      to: optional<DraftTo>
      cc: optional<DraftCc>
      bcc: optional<DraftBcc>
      subject: optional<DraftSubject>
      preview: optional<DraftPreview>
      attachments: optional<DraftAttachments>
      in_reply_to: optional<DraftInReplyTo>
      references: optional<DraftReferences>

  Draft:
    properties:
      inbox_id: inboxes.InboxId
      thread_id: threads.ThreadId
      draft_id: DraftId
      event_id: DraftEventId
      labels: DraftLabels
      updated_at: DraftUpdatedAt
      created_at: DraftCreatedAt
      to: optional<DraftTo>
      cc: optional<DraftCc>
      bcc: optional<DraftBcc>
      subject: optional<DraftSubject>
      preview: optional<DraftPreview>
      text: optional<DraftText>
      html: optional<DraftHtml>
      attachments: optional<DraftAttachments>
      in_reply_to: optional<DraftInReplyTo>
      references: optional<DraftReferences>
    examples:
      - name: CustomName
        value:
          inbox_id: "yourinbox@agentmail.to"
          thread_id: "thread_123"
          draft_id: "draft_123"
          event_id: "event_123"
          labels:
            - "RECEIVED"
            - "UNREAD"
          updated_at: "2024-01-15T09:30:00Z"
          created_at: "2024-01-15T09:30:00Z"
          to: ["bob@example.com"]
          cc: ["charlie@example.com"]
          bcc: ["david@example.com"]
          subject: "Project Discussion"
          preview: "Let's review the timeline for the project."
          text: "Let's review the timeline for the project. How does tomorrow look?"
          html: "<p>Let's review the timeline for the project. How does tomorrow look?</p>"
          attachments:
            [
              {
                attachment_id: "att_123",
                filename: "proposal.pdf",
                content_type: "application/pdf",
                size: 1024,
                inline: false,
              },
            ]
          in_reply_to: "msg_122"
          references: ["msg_121", "msg_122"]

  ListDraftsResponse:
    properties:
      count: shared.Count
      limit: optional<shared.Limit>
      last_key: optional<shared.LastKey>
      drafts:
        type: list<DraftItem>
        docs: Draft items. Ordered by `updated_at` descending.
    examples:
      - name: CustomName
        value:
          drafts:
            - inbox_id: "yourinbox@agentmail.to"
              thread_id: "thread_123"
              draft_id: "draft_123"
              event_id: "event_123"
              labels:
                - "RECEIVED"
                - "UNREAD"
              updated_at: "2024-01-15T09:30:00Z"
              created_at: "2024-01-15T09:30:00Z"
              to: ["bob@example.com"]
              subject: "Project Discussion"
              preview: "Let's review the timeline for the project."
              cc: ["charlie@example.com"]
              bcc: ["david@example.com"]
              attachments:
                [
                  {
                    attachment_id: "att_123",
                    filename: "proposal.pdf",
                    content_type: "application/pdf",
                    size: 1024,
                    inline: false,
                  },
                ]
            - inbox_id: "yourinbox@agentmail.to"
              thread_id: "thread_123"
              draft_id: "draft_456"
              event_id: "event_456"
              labels:
                - "SENT"
              updated_at: "2024-01-15T10:15:00Z"
              created_at: "2024-01-15T10:15:00Z"
              to: ["alice@example.com"]
              subject: "Re: Project Discussion"
              preview: "Sounds good, let's meet tomorrow."
          limit: 10
          count: 2
          last_key: "draft_456#2024-01-15T10:15:00Z"

service:
  base-path: /inboxes/{inbox_id}
  path-parameters:
    inbox_id: inboxes.InboxId

  auth: true

  endpoints:
    list:
      method: GET
      path: /drafts
      display-name: List Drafts
      request:
        name: ListDraftsRequest
        query-parameters:
          limit: optional<shared.Limit>
          last_key: optional<shared.LastKey>
          labels: optional<shared.Labels>
      response: ListDraftsResponse
      errors:
        - shared.NotFoundError
      examples:
        - path-parameters:
            inbox_id: yourinbox@agentmail.to
          query-parameters:
            limit: 10
          response:
            body: $ListDraftsResponse.CustomName

    get:
      method: GET
      path: /drafts/{draft_id}
      display-name: Get Draft
      path-parameters:
        draft_id: DraftId
      response: Draft
      errors:
        - shared.NotFoundError
      examples:
        - path-parameters:
            inbox_id: yourinbox@agentmail.to
            draft_id: "draft_123"
          response:
            body: $Draft.CustomName
