# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  global: ../__package__.yml
  inboxes: __package__.yml
  messages: ../messages.yml
  attachments: ../attachments.yml

service:
  url: Http
  base-path: /inboxes/{inbox_id}/messages
  path-parameters:
    inbox_id: inboxes.InboxId
  auth: true

  endpoints:
    list:
      method: GET
      path: ""
      display-name: List Messages
      docs: Returns all email messages in a specific inbox with options to filter by thread, date, or status.
      request:
        name: ListMessagesRequest
        query-parameters:
          limit: optional<global.Limit>
          page_token: optional<global.PageToken>
          labels: optional<global.Labels>
          before: optional<global.Before>
          after: optional<global.After>
          ascending: optional<global.Ascending>
      response: messages.ListMessagesResponse
      errors:
        - global.NotFoundError

    get:
      method: GET
      path: /{message_id}
      display-name: Get Message
      docs: Retrieves the full content of a specific email message including body, headers, and attachments.
      path-parameters:
        message_id: messages.MessageId
      response: messages.Message
      errors:
        - global.NotFoundError

    getAttachment:
      method: GET
      path: /{message_id}/attachments/{attachment_id}
      display-name: Get Attachment
      docs: Downloads the binary content of a specific email attachment.
      path-parameters:
        message_id: messages.MessageId
        attachment_id: attachments.AttachmentId
      response: file
      errors:
        - global.NotFoundError

    getRaw:
      method: GET
      path: /{message_id}/raw
      display-name: Get Raw Message
      docs: Returns the raw email message content including all headers and MIME parts.
      path-parameters:
        message_id: messages.MessageId
      response: file
      errors:
        - global.NotFoundError

    send:
      method: POST
      path: /send
      display-name: Send Message
      docs: Sends a new email message from the specified inbox to one or more recipients.
      request: messages.SendMessageRequest
      response: messages.SendMessageResponse
      errors:
        - global.ValidationError
        - global.NotFoundError
        - messages.MessageRejectedError

    reply:
      method: POST
      path: /{message_id}/reply
      display-name: Reply To Message
      docs: Sends a reply to an existing message, automatically maintaining the email thread and conversation context.
      path-parameters:
        message_id: messages.MessageId
      request: messages.ReplyToMessageRequest
      response: messages.SendMessageResponse
      errors:
        - global.ValidationError
        - global.NotFoundError
        - messages.MessageRejectedError

    update:
      method: PATCH
      path: /{message_id}
      display-name: Update Message
      docs: Updates message metadata such as read status, labels, or custom flags.
      path-parameters:
        message_id: messages.MessageId
      request: messages.UpdateMessageRequest
      response: messages.Message
      errors:
        - global.ValidationError
        - global.NotFoundError
