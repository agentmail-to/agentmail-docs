# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  global: __package__.yml
  pods: pods/__package__.yml

types:
  DomainId:
    type: string
    docs: The name of the domain. (e.g., " your-domain.com")

  DomainName:
    type: string
    docs: The name of the domain. (e.g., "example.com")

  RecordType:
    enum:
      - TXT
      - CNAME
      - MX

  VerificationStatus:
    enum:
      - NOT_STARTED
      - PENDING
      - INVALID
      - FAILED
      - VERIFYING
      - VERIFIED

  RecordStatus:
    enum:
      - MISSING
      - VERIFIED

  VerificationRecord:
    properties:
      type:
        type: RecordType
        docs: The type of the DNS record.
      name:
        type: string
        docs: The name or host of the record.
      value:
        type: string
        docs: The value of the record.
      status:
        type: RecordStatus
        docs: The verification status of this specific record.
      priority:
        type: optional<integer>
        docs: The priority of the MX record.

  FeedbackEnabled:
    type: boolean
    docs: Bounce and complaint notifications are sent to your inboxes.

  ClientId:
    type: string
    docs: Client ID of domain.

  Domain:
    properties:
      pod_id: optional<pods.PodId>
      domain_id: DomainId
      status:
        type: VerificationStatus
        docs: The verification status of the domain.
      feedback_enabled: FeedbackEnabled
      records:
        type: list<VerificationRecord>
        docs: A list of DNS records required to verify the domain.
      client_id: optional<ClientId>
      updated_at:
        type: datetime
        docs: Time at which the domain was last updated.
      created_at:
        type: datetime
        docs: Time at which the domain was created.

  DomainItem:
    properties:
      pod_id: optional<pods.PodId>
      domain_id: DomainId
      feedback_enabled: FeedbackEnabled
      client_id: optional<ClientId>
      updated_at:
        type: datetime
        docs: Time at which the domain was last updated.
      created_at:
        type: datetime
        docs: Time at which the domain was created.

  ListDomainsResponse:
    properties:
      count: global.Count
      limit: optional<global.Limit>
      next_page_token: optional<global.PageToken>
      domains:
        type: list<DomainItem>
        docs: Ordered by `created_at` descending.

  CreateDomainRequest:
    properties:
      domain: DomainName
      feedback_enabled: FeedbackEnabled

service:
  url: Http
  base-path: /domains
  auth: true

  endpoints:
    list:
      method: GET
      path: ""
      display-name: List Domains
      request:
        name: ListDomainsRequest
        query-parameters:
          limit: optional<global.Limit>
          page_token: optional<global.PageToken>
      response: ListDomainsResponse

    get:
      method: GET
      path: /{domain_id}
      display-name: Get Domain
      path-parameters:
        domain_id: DomainId
      response: Domain
      errors:
        - global.NotFoundError

    getZoneFile:
      method: GET
      path: /{domain_id}/zone-file
      display-name: Get Zone File
      path-parameters:
        domain_id: DomainId
      response: file
      errors:
        - global.NotFoundError

    create:
      method: POST
      path: ""
      display-name: Create Domain
      request: CreateDomainRequest
      response: Domain
      errors:
        - global.ValidationError

    delete:
      method: DELETE
      path: /{domain_id}
      display-name: Delete Domain
      path-parameters:
        domain_id: DomainId
      errors:
        - global.NotFoundError

    verify:
      method: POST
      path: /{domain_id}/verify
      display-name: Verify Domain
      path-parameters:
        domain_id: DomainId
      errors:
        - global.NotFoundError
